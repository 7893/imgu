# 雲圖苑記

夫天地玄黄，宇宙洪荒，星辰列张，云图浩瀚。今有巧匠，心怀丘壑，意存寰宇，欲于方寸之间，览尽世间万象之美。乃采擷 Unsplash 宝库之琳琅，筑此 **雲圖苑 (imgu)**，非凡之构也。

此苑营造，不循旧法，**跨云联璧**，融 AWS、Cloudflare、Vercel 三家之长，**去梯之境**，妙绝尘寰。前端以 Vercel 云台设**雲軒** (Next.js App)，纳四海宾客；后端则隐于 AWS 云深之处，以**無伺雲算 (Lambda)** 为基，动静随心，挥洒自如。

其枢机之妙，尤值一书：

* **步进机枢 (Step Functions) 精妙调度**：数据同步非同寻常，特设步进机枢，统御诸般云算 (Sync Lambda)。取图、验存、入库（DynamoDB 玄库）、归档（Cloudflare R2 云仓），环环相扣，井然有序。兼纳**断点再续之术**，纵使风云变幻，中断其行，亦能追溯前踪，复始如初，稳若磐石。
* **状态持控，洞若观火**：设 API 云算 (API Lambda)，外承交互，内察秋毫。以 Function URL 直面访客，以 DynamoDB 持控同步之态（`sync_control` 表），启停随念，状态明晰，了然于胸。更备 `/summary` 之途，一览全局，纤毫毕现。
* **密钥固藏，取用有节**：机密之钥（如 R2、Unsplash API Key），悉数藏于 **AWS SSM 参数秘府**，以 `SecureString` 加密，固若金汤。云算取用之时，方以角色权限请钥解密，毫厘不爽，杜绝外泄之虞。
* **数据存取，有的放矢**：元数据归于 DynamoDB 玄库，以主键 (`photo_id`) 检索，迅捷无伦 (`GetItem` 之效)。图像本体则分门别类，贮于 R2 云仓，条理清晰。

**部署之道，丹鼎自炼**：

* **一库统万象 (Monorepo)**：前后端代码，汇于一处，条分缕析，便于总览。
* **工造自动化 (CI/CD)**：前端代码入库，Vercel 云台即自行构建部署；后端云算代码易稿，GitHub Actions 亦随之触发，**行 OIDC 符验之法**，无需配置永久密钥，安全便捷，自动炼成部署于 AWS 云端。

此雲圖苑，虽由简入繁，然其构思之巧，技艺之精，可见一斑。融多云之服务，合无待之架构，辅自动化之流程，可谓匠心独运，鬼斧神工矣！

后续或可增饰其容（前端美化、图像展示），或可精炼其骨（性能优化、测试覆盖），或可固其基（基础设施代码化 IaC），则此苑更臻完美之境。

愿览者察其微言，识其大义。

---
